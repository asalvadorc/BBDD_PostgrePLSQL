<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://asalvadorc.github.io/BBDD_POSTGREPLSQL/7_missatges_i_excepcions/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>7. Missatges - BD - Bases de Dades</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/extra.css" rel="stylesheet" />
        <link href="../img/favicon.ico" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "7. Missatges";
        var mkdocs_page_input_path = "7_missatges_i_excepcions.md";
        var mkdocs_page_url = "/BBDD_POSTGREPLSQL/7_missatges_i_excepcions/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="..">
          <img src="../assets/logocaminas.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Programació en PostgreSQL</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../objectius_i_coneixements_previs/">Objectius</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../0_nota_inicial/">0. DDL, DML de la BD per als exercicis</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../1_introducci/">1. Introducció</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2_plpgsql/">2. PL/pgSQL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_declaraci_de_variables/">3. Declaració de variables</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../4_instruccions/">4. Instruccions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../5_funcions/">5. Funcions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../6_utilitzaci_de_cursors/">6. Utilització de cursors</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">7. Missatges</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../8_triggers/">8. Triggers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../exercicis_de_tot_el_tema/">Exercicis de tot el tema</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../exercicis_repas/">Exercicis de repàs</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">BD - Bases de Dades</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Programació en PostgreSQL</li>
      <li class="breadcrumb-item active">7. Missatges</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="7-missatges-i-excepcions">7. Missatges i excepcions</h1>
<p>Al llarg dels exemples i exercicis que hem fet fins ara, ens ha vingut molt bé
traure algun missatge, per veure com anava l'execució de les funcions. El que
feem era provocar un aconteixement, en aquest cas una notícia, un avís. Podem
utilitzar la mateixa sentència per a provocar també un error, amb el
conseqüent avortament de l'execució de la funció. Anem a veure-ho amb més
detall.</p>
<pre><code>RAISE nivell 'format' [,variable1[,...]];
</code></pre>
<p>En nivell posarem un dels següents: <strong>DEBUG</strong> , <strong>LOG</strong> , <strong>INFO</strong> ,
<strong>NOTICE</strong> , <strong>WARNING</strong> o <strong>EXCEPTION</strong> , on la major part només donen un
avís (amb l'encapçalament corresponent). Però <strong>EXCEPTION</strong> a més de traure
l'avís avorta l'execució.</p>
<p>En format posarem una cadena amb el comentari que vulguem. Podrem posar <strong>%</strong>
les vegades que vulguem, i se substituiran pel contingut de les variables que
tinguem a continuació.</p>
<p>Així, per exemple, creem una funció de salutació:</p>
<pre><code>CREATE OR REPLACE FUNCTION SALUTACIO() RETURNS VOID as $COS$
DECLARE
    s1 text := 'Joanet';
    s2 date := CURRENT_DATE;
BEGIN
    RAISE NOTICE 'Hola';
    RAISE NOTICE 'Hola, %. Avui és %',s1,s2;
    RAISE NOTICE 'Què tal?';
END; $COS$
LANGUAGE 'plpgsql';
</code></pre>
<p>Si ara fem:</p>
<pre><code>SELECT SALUTACIO();
</code></pre>
<p>Provocarà la següent eixida (en la pestanya <strong>Output</strong>):</p>
<pre><code>Hola, Joanet. Avui es 2022-02-14  
Què tal?
</code></pre>
<p>En canvi si la canviem el primer RAISE NOTICE per un <strong>RAISE EXCEPTION</strong> , i
posem un altre RAISE NOTICE davant:</p>
<pre><code>CREATE OR REPLACE FUNCTION SALUTACIO() RETURNS VOID as $COS$
DECLARE
    s1 text := 'Joanet';
    s2 date := CURRENT_DATE;
BEGIN
    RAISE NOTICE 'Hola';
    RAISE EXCEPTION 'Hola, %. Avui és %',s1,s2;
    RAISE NOTICE 'Què tal?';
END;
$COS$ LANGUAGE 'plpgsql';
</code></pre>
<p>Només trauria el primer Hola, i després donaria un error amb el missatge que
li hem posat:</p>
<p><img alt="" src="../T7_5_3.png" /></p>
<p>I no trauria això de <strong>Què tal?</strong> , perquè ja s'ha avortat la funció. És a
dir, hem provocat nosaltres l'error</p>
<p>Llicenciat sota la  <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Llicència Creative Commons Reconeixement NoComercial
CompartirIgual 3.0</a></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../6_utilitzaci_de_cursors/" class="btn btn-neutral float-left" title="6. Utilització de cursors"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../8_triggers/" class="btn btn-neutral float-right" title="8. Triggers">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../6_utilitzaci_de_cursors/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../8_triggers/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
